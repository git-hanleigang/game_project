{"version":3,"sources":["file:///Users/xcyy/Desktop/createrPro/cashSlot/assets/scripts/reelRoll.ts"],"names":["_decorator","Component","Node","UITransform","Singleton","symbolNode","ccclass","property","reelRoll","Number","type","tooltip","singleton","getInstance","symbolList","currMoveLength","reelRowNum","colNum","rollStates","quickStop","rollSymbolTypes","rollPoint","rollListLength","start","reelColAndRow","length","curColIndex","rollList","initReel","update","deltaTime","iRow","addNode","getUnActiveSymbol","symbolType","getSmbolType","active","createSymbolNode","setPosition","reelWidth","symbolHeight","newNode","node","addChild","uiTra","addComponent","anchorX","anchorY","script","init","updateSymbolNodeInfo","getComponent","removePosY","changeSymbolNode","row","symbolListLength","index","beginReel","stopReel"],"mappings":"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","sourcesContent":["import { _decorator, Component, EditBox, Node, UITransform } from 'cc';\nconst { ccclass, property } = _decorator;\nimport Singleton from './Singleton';\nimport { symbolNode } from './symbolNode';\n\n@ccclass('reelRoll')\nexport class reelRoll extends Component {\n    public singleton: Singleton = Singleton.getInstance()\n    public symbolList: Node[] = []\n    public currMoveLength: number = 0\n    public reelRowNum: number = 0\n    public colNum: number = null; // 行配置\n    public rollStates: boolean = false\n    public quickStop: boolean = false\n    public rollSymbolTypes: number[] = []\n    public rollPoint: number = 0; // 滚动指针\n    public rollListLength: number = null; // 滚动指针\n    @property(Number)\n    public curColIndex: number = 0\n    @property({ type: Number, tooltip:\"小块高度\"})\n    public symbolHeight: any = 160;\n    @property({ type: Number, tooltip:\"reel条宽度度\"})\n    public reelWidth: any = 210;\n    start() {\n        this.colNum = this.singleton.reelColAndRow.length\n        this.reelRowNum = this.singleton.reelColAndRow[this.curColIndex]\n        this.rollSymbolTypes = this.singleton.rollList[this.curColIndex]\n        this.rollPoint = 0\n        this.rollListLength = this.rollSymbolTypes.length\n\n        this.initReel()\n    }\n\n    update(deltaTime: number) {\n        \n    }\n\n    initReel(){\n        for(let iRow = 1; iRow < this.reelRowNum; iRow++){\n            let addNode = this.getUnActiveSymbol(iRow)\n            let symbolType = this.getSmbolType()\n            if (addNode != null){\n                addNode.active = true\n            }else{\n                addNode = this.createSymbolNode(symbolType, iRow)\n                this.symbolList[this.symbolList.length] = addNode\n            }\n            addNode.setPosition(this.reelWidth/2, iRow*this.symbolHeight)\n        }\n    }\n\n    public createSymbolNode(symbolType: number, iRow: number): Node {\n        let newNode = new Node()\n        this.node.addChild(newNode)\n\n        let uiTra = newNode.addComponent(UITransform)\n        uiTra.anchorX = 0.5\n        uiTra.anchorY = 0 \n\n        let script = newNode.addComponent(symbolNode)\n        script.init()\n\n        this.updateSymbolNodeInfo(newNode, iRow, symbolType)\n        return newNode\n    }\n\n    updateSymbolNodeInfo(node: Node, iRow: number, symbolType: number) {\n        // node.setSiblingIndex(symbolType)\n        let script = node.getComponent(symbolNode)\n        script.iRow = iRow\n        script.symbolType = symbolType\n\n        script.removePosY = -this.symbolHeight\n        script.changeSymbolNode(symbolType)\n    }\n\n    public getSmbolType(): number{\n        let symbolType = this.rollSymbolTypes[this.rollPoint] \n        this.rollPoint = this.rollPoint + 1\n        if (this.rollPoint >= this.rollListLength ) {\n            this.rollPoint = 0\n        }\n        return symbolType\n    }\n\n    public getUnActiveSymbol(row: number): any{\n        let symbolListLength = this.symbolList.length\n        for(let index = 0; index < symbolListLength; index++){\n            let node = this.symbolList[index]\n            if (node.active == false){\n                return node\n            }\n        }\n        return null\n    }\n\n    public beginReel(){\n        this.currMoveLength = 0\n        this.rollStates = true\n        this.quickStop = false\n    }\n\n    public stopReel(){\n        this.rollStates = false\n\n    }\n}\n\n"]}